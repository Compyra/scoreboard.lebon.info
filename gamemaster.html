<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Master Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <a href="leaderboard.html" class="leaderboard-link">ğŸ† Leaderboard</a>
    <a href="index.html" class="back-link">â† Back to Challenge Page</a>
    
    <div class="gm-container">
        <!-- Login Form (shown when not authenticated) -->
        <div id="loginSection">
            <h1 id="loginTitle">Game Master Login</h1>
            <p class="subtitle" id="loginSubtitle">Enter password to access dashboard</p>
            
            <div class="login-form">
                <div id="setupInfo" class="info-message" style="display: none;">
                    ğŸ”‘ No password has been set yet. Please choose a secure password that you will use to access the Game Master dashboard in the future.
                </div>
                
                <div id="loginError" class="error-message" style="display: none;">
                    Incorrect password. Please try again.
                </div>
                
                <input type="password" id="passwordInput" placeholder="Enter password" autocomplete="current-password">
                <button type="button" class="btn btn-primary" onclick="login()" id="loginButton" style="width: 100%;">Login</button>
            </div>
        </div>

        <!-- Dashboard (shown when authenticated) -->
        <div id="dashboardSection" style="display: none;">
            <div class="gm-header">
                <h1>Game Master Dashboard</h1>
                <div class="gm-actions">
                    <button class="btn btn-primary" onclick="exportToCSV()">ğŸ“Š Export to CSV</button>
                    <button class="btn btn-primary" onclick="showChangePassword()">ğŸ”‘ Change Password</button>
                    <button class="btn btn-primary" onclick="showSettings()">âš™ï¸ Settings</button>
                    <button class="btn btn-secondary" onclick="logout()">ğŸšª Logout</button>
                </div>
            </div>

            <div id="changePasswordModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <h2>Change Password</h2>
                    <div id="changePasswordError" class="error-message" style="display: none;"></div>
                    <div class="form-group">
                        <label for="newPassword">New Password:</label>
                        <input type="password" id="newPassword" placeholder="Enter new password">
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">Confirm Password:</label>
                        <input type="password" id="confirmPassword" placeholder="Confirm new password">
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn btn-primary" onclick="changePassword()">Save New Password</button>
                        <button class="btn btn-secondary" onclick="closeChangePassword()">Cancel</button>
                    </div>
                </div>
            </div>

            <div id="settingsModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <h2>âš™ï¸ Settings & Information</h2>
                    
                    <div class="info-section">
                        <h3>About This Application</h3>
                        <p>Challenger Registration & Scoreboard System</p>
                        <p class="info-detail">Version 1.0.0</p>
                        <p class="info-detail">This application allows challengers to register their information and enables game masters to track scores, attempts, and additional notes.</p>
                    </div>
                    
                    <div class="settings-section">
                        <h3>Security Settings</h3>
                        <div class="checkbox-container">
                            <label>
                                <input type="checkbox" id="autoLogoutCheckbox" onchange="toggleAutoLogout()">
                                <span>Auto-logout on page reload or navigation</span>
                            </label>
                            <p class="setting-description">When enabled, you will be automatically logged out when refreshing the page or navigating between challenger and game master pages.</p>
                        </div>
                    </div>
                    
                    <div class="settings-section danger-zone">
                        <h3>âš ï¸ Danger Zone</h3>
                        <p class="info-detail">Permanently delete all challenger data. This action cannot be undone!</p>
                        <div class="form-group" style="margin-top: 15px;">
                            <label for="deletePassword" style="color: black;">Enter Password to Confirm:</label>
                            <input type="password" id="deletePassword" placeholder="Enter your password">
                        </div>
                        <button class="btn btn-danger" onclick="deleteAllData()" style="margin-top: 10px;">ğŸ—‘ï¸ Delete All Challenger Data</button>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn btn-primary" onclick="closeSettings()">Close</button>
                    </div>
                </div>
            </div>

            <div id="challengersContainer">
                <div class="no-challengers">No challengers registered yet.</div>
            </div>
        </div>
    </div>

    <script src="gamemaster.js"></script>
</body>
</html>
